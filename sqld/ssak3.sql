-- 싹쓰리 테이블
CREATE TABLE SSAK3 (
	NO				NUMBER(1),
	TITLE 			VARCHAR2(100),
	COUNT_DT		VARCHAR(8),
	DOWNLOAD_CNT 	NUMBER(4)
);

INSERT INTO SSAK3 VALUES (1, '다시 여기 바닷가', '20200801', ROUND(DBMS_RANDOM.VALUE(100, 1000),0));
INSERT INTO SSAK3 VALUES (2, '그 여름을 틀어줘', '20200801', ROUND(DBMS_RANDOM.VALUE(100, 1000),0));
INSERT INTO SSAK3 VALUES (3, '여름 안에서 by 싹쓰리(Feat.황광희)', '20200801', ROUND(DBMS_RANDOM.VALUE(100, 1000),0));
INSERT INTO SSAK3 VALUES (4, 'LINDA(Feat.윤미래)', '20200801', ROUND(DBMS_RANDOM.VALUE(100, 1000),0));
INSERT INTO SSAK3 VALUES (5, '두리쥬와(Feat.S.B.N)', '20200801', ROUND(DBMS_RANDOM.VALUE(100, 1000),0));
INSERT INTO SSAK3 VALUES (6, '신난다(Feat.마마무)', '20200801', ROUND(DBMS_RANDOM.VALUE(100, 1000),0));
INSERT INTO SSAK3 VALUES (7, '다시 여기 바닷가(Acoustic Ver.)', '20200801', ROUND(DBMS_RANDOM.VALUE(100, 1000),0));
INSERT INTO SSAK3 VALUES (1, '다시 여기 바닷가', '20200802', ROUND(DBMS_RANDOM.VALUE(100, 1000),0));
INSERT INTO SSAK3 VALUES (2, '그 여름을 틀어줘', '20200802', ROUND(DBMS_RANDOM.VALUE(100, 1000),0));
INSERT INTO SSAK3 VALUES (3, '여름 안에서 by 싹쓰리(Feat.황광희)', '20200802', ROUND(DBMS_RANDOM.VALUE(100, 1000),0));
INSERT INTO SSAK3 VALUES (4, 'LINDA(Feat.윤미래)', '20200802', ROUND(DBMS_RANDOM.VALUE(100, 1000),0));
INSERT INTO SSAK3 VALUES (5, '두리쥬와(Feat.S.B.N)', '20200802', ROUND(DBMS_RANDOM.VALUE(100, 1000),0));
INSERT INTO SSAK3 VALUES (6, '신난다(Feat.마마무)', '20200802', ROUND(DBMS_RANDOM.VALUE(100, 1000),0));
INSERT INTO SSAK3 VALUES (7, '다시 여기 바닷가(Acoustic Ver.)', '20200802', ROUND(DBMS_RANDOM.VALUE(100, 1000),0));
INSERT INTO SSAK3 VALUES (1, '다시 여기 바닷가', '20200803', ROUND(DBMS_RANDOM.VALUE(100, 1000),0));
INSERT INTO SSAK3 VALUES (2, '그 여름을 틀어줘', '20200803', ROUND(DBMS_RANDOM.VALUE(100, 1000),0));
INSERT INTO SSAK3 VALUES (3, '여름 안에서 by 싹쓰리(Feat.황광희)', '20200803', ROUND(DBMS_RANDOM.VALUE(100, 1000),0));
INSERT INTO SSAK3 VALUES (4, 'LINDA(Feat.윤미래)', '20200803', ROUND(DBMS_RANDOM.VALUE(100, 1000),0));
INSERT INTO SSAK3 VALUES (5, '두리쥬와(Feat.S.B.N)', '20200803', ROUND(DBMS_RANDOM.VALUE(100, 1000),0));
INSERT INTO SSAK3 VALUES (6, '신난다(Feat.마마무)', '20200803', ROUND(DBMS_RANDOM.VALUE(100, 1000),0));
INSERT INTO SSAK3 VALUES (7, '다시 여기 바닷가(Acoustic Ver.)', '20200803', ROUND(DBMS_RANDOM.VALUE(100, 1000),0));

-- 누적값 구하기
SELECT A.NO, 
       MAX(A.TITLE) TITLE,
       A.COUNT_DT, 
       MAX(A.DOWNLOAD_CNT) DOWNLOAD_CNT, 
       SUM(B.DOWNLOAD_CNT) "누적값"
  FROM SSAK3 A, SSAK3 B
 WHERE A.NO = B.NO
   AND A.COUNT_DT >= B.COUNT_DT
 GROUP BY A.NO, A.COUNT_DT
 ORDER BY A.NO, A.COUNT_DT;
 
-- 윈도우 함수
SELECT NO, TITLE, COUNT_DT, DOWNLOAD_CNT,
    SUM(DOWNLOAD_CNT) OVER(PARTITION BY NO ORDER BY COUNT_DT 
                ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) "누적값",
    SUM(DOWNLOAD_CNT) OVER(PARTITION BY NO ORDER BY COUNT_DT 
                ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) "거꾸로누적값"
    FROM SSAK3;
                
                


